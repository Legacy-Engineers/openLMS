{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Admin Settings - A&F Laundry Management{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h3 mb-0">
            <i class="fas fa-cogs text-primary me-2"></i>
            System Administration
        </h1>
        <p class="text-muted mb-0">Manage system configuration and settings</p>
    </div>
</div>

<!-- Quick Stats Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Total Users</h6>
                        <h3 class="mb-0">{{ total_users }}</h3>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-users fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Email Templates</h6>
                        <h3 class="mb-0">{{ total_email_templates }}</h3>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-envelope fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Company</h6>
                        <h6 class="mb-0">{{ system_config.company_name }}</h6>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-building fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Currency</h6>
                        <h3 class="mb-0">{{ system_config.currency_symbol }}</h3>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-money-bill fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Admin Menu Grid -->
<div class="row">
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-building text-primary" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">System Configuration</h5>
                <p class="card-text text-muted">
                    Configure company information, currency, timezone, and business rules
                </p>
                <a href="{% url 'system_settings:system_config' %}" class="btn btn-primary">
                    <i class="fas fa-cog me-1"></i>
                    Configure System
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-envelope-open-text text-success" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">Email Configuration</h5>
                <p class="card-text text-muted">
                    Setup SMTP settings, email templates, and test email delivery
                </p>
                <a href="{% url 'system_settings:email_config' %}" class="btn btn-success">
                    <i class="fas fa-envelope me-1"></i>
                    Configure Email
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-users-cog text-info" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">User Management</h5>
                <p class="card-text text-muted">
                    Manage users, roles, permissions, and user access controls
                </p>
                <a href="{% url 'system_settings:user_management' %}" class="btn btn-info">
                    <i class="fas fa-users me-1"></i>
                    Manage Users
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-credit-card text-success" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">Payment Methods</h5>
                <p class="card-text text-muted">
                    Configure available payment methods for orders and transactions
                </p>
                <a href="{% url 'system_settings:payment_methods' %}" class="btn btn-success">
                    <i class="fas fa-credit-card me-1"></i>
                    Manage Payment Methods
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-file-alt text-warning" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">Email Templates</h5>
                <p class="card-text text-muted">
                    Customize email templates for notifications and communications
                </p>
                <a href="{% url 'system_settings:email_templates' %}" class="btn btn-warning">
                    <i class="fas fa-edit me-1"></i>
                    Edit Templates
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-clipboard-list text-secondary" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">Audit Log</h5>
                <p class="card-text text-muted">
                    View system activity, changes, and security audit trail
                </p>
                <a href="{% url 'system_settings:audit_log' %}" class="btn btn-secondary">
                    <i class="fas fa-search me-1"></i>
                    View Logs
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 hover-shadow">
            <div class="card-body text-center">
                <div class="mb-3">
                    <i class="fas fa-shield-alt text-danger" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">Django Admin</h5>
                <p class="card-text text-muted">
                    Access the Django admin interface for advanced configuration
                </p>
                <a href="/admin/" class="btn btn-danger" target="_blank">
                    <i class="fas fa-external-link-alt me-1"></i>
                    Open Django Admin
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
{% if recent_audit_logs %}
<div class="card mt-4">
    <div class="card-header">
        <h5 class="mb-0">
            <i class="fas fa-clock me-2"></i>
            Recent Activity
        </h5>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-sm mb-0">
                <thead class="bg-light">
                    <tr>
                        <th>User</th>
                        <th>Action</th>
                        <th>Model</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% for log in recent_audit_logs %}
                    <tr>
                        <td>
                            {% if log.user %}
                                <i class="fas fa-user me-1"></i>
                                {{ log.user.username }}
                            {% else %}
                                <span class="text-muted">System</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="badge bg-primary">{{ log.get_action_type_display }}</span>
                        </td>
                        <td>{{ log.model_name }}</td>
                        <td class="text-muted">{{ log.timestamp|timesince }} ago</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer text-center">
        <a href="{% url 'system_settings:audit_log' %}" class="btn btn-outline-primary btn-sm">
            View Full Audit Log
        </a>
    </div>
</div>
{% endif %}

<style>
.hover-shadow {
    transition: box-shadow 0.3s ease;
}
.hover-shadow:hover {
    box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
    transform: translateY(-2px);
}
</style>
{% endblock %}
